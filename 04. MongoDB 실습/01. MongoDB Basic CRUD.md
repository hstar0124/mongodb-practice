# MongoDB ê¸°ë³¸ CRUD

<aside>
ğŸ’¡ ì¿¼ë¦¬ ì‹¤í–‰ì€ VS Codeì—ì„œ ì§„í–‰í•  ì˜ˆì •
</aside>

### VS ì½”ë“œ ì‹¤í–‰

1. ìƒì„±ëœ ì ‘ì† URI ë³µì‚¬
    
![image](https://user-images.githubusercontent.com/57317290/215934294-4238988b-4db5-41f8-aa87-361f03687d47.png) 

2. VS Code ì—ì„œ í„°ë¯¸ë„ì„ ì—´ê³  ì ‘ì†
    
    ```bash
    $ mongosh "mongodb+srv://cluster0.8b0eqwp.mongodb.net/myFirstDatabase" --apiVersion 1 --username mongo_user
    ```
    
    ```bash
    $ show dbs
    $ use test
    ```
    
![image](https://user-images.githubusercontent.com/57317290/215934325-98b9306e-a4a7-489f-8ef8-dc5fda89b51d.png)
    

## Insert

- **insertOne**
    
    ```sql
    db.employees.insertOne({
        name: "lake",
        age: 21,
        dept: "Database",
        joinDate: new ISODate("2023-01-30"),
        salary: 40000000,
        bonus: null
    })
    ```
    
  ![image](https://user-images.githubusercontent.com/57317290/215934346-17833b09-662d-482b-8125-4bc36c13bda7.png)
    

- **find**
    
    ```sql
    db.employees.find()
    ```
    
![image](https://user-images.githubusercontent.com/57317290/215934371-09a95ebf-e464-424a-af7e-801c405da55e.png)
    

- **insertMany**
    
    ```sql
    db.employees.insertMany([
        {
            name: "ocean",
            age: 44,
            dept: "Network",
            joinDate: new ISODate("1999-11-15"),
            salary: 80000000,
            resignationDate: new ISODate("2002-12-23"),
            bonus: null
        },
        {
            name: "river",
            age: 33,
            dept: "DevOps",
            isNegotiating: true
        }
    ])
    ```
    
    ![image](https://user-images.githubusercontent.com/57317290/215934406-34d542d2-3221-4902-a762-aeb18b1cfb5d.png)
    

- **DBì— ë„£ì–´ì•¼í•  ê°’ì´ ì—¬ëŸ¬ê°œì¼ ë•Œ InsertOne ì—¬ëŸ¬ë²ˆì´ ë¹ ë¥¸ê°€ ì•„ë‹ˆë©´ InsertManyê°€ ë¹ ë¥¸ê°€?**
    
    (ëª½ê³ DBëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜ì´ë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì‚¬ìš© ê°€ëŠ¥)
    
    ë‘ êµ¬ë¬¸ ì‹¤í–‰ ê²°ê³¼ InsertManyê°€ í›¨ì”¬ ë¹ ë¥¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    
    ```sql
    for(i = 0 ; i < 300 ; i++) {
        db.insertTest.insertOne({a: i})
    }
    ```
    
    ```sql
    var docs = []
    for (i = 0 ; i < 300 ; i++) { 
        docs.push({a : i})
    }
    db.insertMany.insertMany(docs);
    ```
    

### Update

- **updateOne**
    
    â€œâ€ ìœ¼ë¡œë§Œ ë‘ë©´ í•´ë‹¹ í•„ë“œë¥¼ ì œê±°í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
    
    ```sql
    db.employees.updateOne(
        { name : "river" },
        {
            $set: {
                salary: 35000000,
                dept: "Database",
                joinDate: new ISODate("2023-01-31")
            },
            $unset: {
                isNegotiating: ""
            }
        }
    )
    ```
    
   ![image](https://user-images.githubusercontent.com/57317290/215934429-5fc82440-15f2-4c1a-989b-40903ea42bc6.png)
    
- **updateMany**
    1. ê·¼ë¬´í•˜ëŠ” ì‚¬ëŒ(í‡´ì‚¬ì¼ì´ ì—†ê³ , ì…ì‚¬ì¼ì´ ìˆëŠ” ì‚¬ëŒ)ì€ ì—°ë´‰ 10% ì¸ìƒ ì¿¼ë¦¬
        
        (Decimal128ì€ ì†Œìˆ˜ì ì„ ì¤„ì´ê¸° ìœ„í•´ì„œ ì‚¬ìš©)
        
        ```sql
        db.employees.updateMany(
            { resignationDate: { $exists: false }, joinDate: { $exists: true } },
            { $mul: { salary: Decimal128("1.1") } }
        )
        ```
        
       ![image](https://user-images.githubusercontent.com/57317290/215934448-749046bd-c639-40d2-ad9c-ec0ac9daeb72.png)
        
    
    1. ë³´ë„ˆìŠ¤ í•„ë“œê°€ ìˆëŠ” ì‚¬ëŒ(ì€í‡´í•œ ì‚¬ëŒ ì œì™¸)ì—ê²Œ ë³´ë„ˆìŠ¤ ì§€ê¸‰ ì¿¼ë¦¬
        
        ```sql
        db.employees.updateMany(
            { resignationDate: { $exists: false }, bonus: { $exists: true } },
            { $set: { bonus: 200000 } }
        )
        ```
        
        ë§Œì•½ ì¿¼ë¦¬ í•„í„°ì— bonus: nullë¡œ í•  ê²½ìš° ë‚´ê°€ ì˜ë„í•œ ê²Œ ì•„ë‹Œ riverë„ ë³´ë„ˆìŠ¤ë¥¼ ë°›ê²Œ ë˜ëŠ” ê²½ìš°ê°€ ìƒê¸¸ìˆ˜ ìˆìœ¼ë‹ˆ ìœ ì˜í•  ê²ƒ!!
        
       ![image](https://user-images.githubusercontent.com/57317290/215934463-031a48ed-7801-4c96-b9f0-5efe3fe5a815.png)
        

### DELETE

- **deleteOne**
    
    ```sql
    db.employees.deleteOne(
        {name: "river" }
    )
    ```
    
  ![image](https://user-images.githubusercontent.com/57317290/215934484-c3c2c051-0a88-4487-8d9d-563fe26c79fb.png)
    

- **deleteMany**
    
    ì¿¼ë¦¬ í•„í„°ì— ë¹ˆì¹¸ì´ë¼ë„ ë„£ì–´ì¤˜ì•¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë¦¬ê³  ì»¬ë ‰ì…˜ ìì²´ëŠ” ì‚­ì œë˜ì§€ ì•ŠëŠ”ë‹¤.
    
    ```sql
    db.employees.deleteMany({})
    ```
    
  ![image](https://user-images.githubusercontent.com/57317290/215934499-be958232-c3be-4a0b-93f2-ddf69e6dad45.png)
    
- **drop**
    
    ì»¬ë ‰ì…˜ ì‚­ì œ ì¿¼ë¦¬
    
    ```sql
    db.{collection Name}.drop()
    ```
    
   ![image](https://user-images.githubusercontent.com/57317290/215934513-fba751f3-aff5-4bd7-bad9-a9ff00d54176.png)
    

### FIND

- Sample ë°ì´í„° í™œìš©í•  ì˜ˆì •
    
    ![image](https://user-images.githubusercontent.com/57317290/215934545-c0ffd0f0-100d-4a90-bfe4-f311e9e8d1e3.png)
    
- **findOne**
    
    ```sql
    db.planets.findOne({ name: "Mars" })
    ```
    
  ![image](https://user-images.githubusercontent.com/57317290/215934592-d44186cb-bb7d-44fd-adfb-fac0107f25a8.png)
    
- **find**
    
    ```sql
    // ë§ì„ ê°€ì§€ê³  ìˆê³  orderFromSunì´ 6ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ê°’(, ë¡œ ì—°ê²°í•  ê²½ìš° ê¸°ë³¸ì ìœ¼ë¡œ and ì¡°ê±´)
    db.planets.find({ 
        hasRings: true, 
        orderFromSun: { $lte: 6 }
    })
    
    ==
    
    db.planets.find({ 
        $and: [
            { hasRings: true }, 
            { orderFromSun: { $lte: 6 } }
        ]
    })
    ```
    
  ![image](https://user-images.githubusercontent.com/57317290/215934628-553a7bb0-7b38-405b-a7c7-02efb31903f3.png)
    
    ```sql
    // ë§ì´ ì—†ê±°ë‚˜ orderFromSunì´ 6ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ê°’
    
    db.planets.find({ 
        $or: [
            { hasRings: { $ne: false } }, 
            { orderFromSun: { $gt: 6 } }
        ]
    })
    ```
    
   ![image](https://user-images.githubusercontent.com/57317290/215934655-b2ea7d7e-d4cc-483d-88b3-18e0eb9db4f6.png)
    
    ```sql
    // íŠ¹ì • ë°°ì—´ì•ˆì— ìˆëŠ” ê°’ì¤‘ì— í•´ë‹¹ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì¿¼ë¦¬
    db.planets.find(
        { mainAtmosphere: { $in: ['O2'] } }
    )
    ```
    
   ![image](https://user-images.githubusercontent.com/57317290/215934674-440fb211-f0ee-47f2-9b67-122cbae418a0.png)
