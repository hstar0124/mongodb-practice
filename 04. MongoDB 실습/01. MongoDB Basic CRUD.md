# MongoDB ê¸°ë³¸ CRUD

<aside>
ğŸ’¡ ì¿¼ë¦¬ ì‹¤í–‰ì€ VS Codeì—ì„œ ì§„í–‰í•  ì˜ˆì •
</aside>

### VS ì½”ë“œ ì‹¤í–‰

1. ìƒì„±ëœ ì ‘ì† URI ë³µì‚¬
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/88414216-3585-4c0e-b72f-b5080fc45f89/Untitled.png)
    

2. VS Code ì—ì„œ í„°ë¯¸ë„ì„ ì—´ê³  ì ‘ì†
    
    ```bash
    $ mongosh "mongodb+srv://cluster0.8b0eqwp.mongodb.net/myFirstDatabase" --apiVersion 1 --username mongo_user
    ```
    
    ```bash
    $ show dbs
    $ use test
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/37aba2c0-200e-423b-8569-91a1cb921af7/Untitled.png)
    

## Insert

- **insertOne**
    
    ```sql
    db.employees.insertOne({
        name: "lake",
        age: 21,
        dept: "Database",
        joinDate: new ISODate("2023-01-30"),
        salary: 40000000,
        bonus: null
    })
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4aab54b9-aa79-477b-9298-52c1ee1c04c3/Untitled.png)
    

- **find**
    
    ```sql
    db.employees.find()
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/368df94e-7b50-4422-a605-082280fadc8e/Untitled.png)
    

- **insertMany**
    
    ```sql
    db.employees.insertMany([
        {
            name: "ocean",
            age: 44,
            dept: "Network",
            joinDate: new ISODate("1999-11-15"),
            salary: 80000000,
            resignationDate: new ISODate("2002-12-23"),
            bonus: null
        },
        {
            name: "river",
            age: 33,
            dept: "DevOps",
            isNegotiating: true
        }
    ])
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b5d7d906-4c71-4700-9290-1d33775612fc/Untitled.png)
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f734d81f-3764-4396-8019-07043e64a6b9/Untitled.png)
    

- **DBì— ë„£ì–´ì•¼í•  ê°’ì´ ì—¬ëŸ¬ê°œì¼ ë•Œ InsertOne ì—¬ëŸ¬ë²ˆì´ ë¹ ë¥¸ê°€ ì•„ë‹ˆë©´ InsertManyê°€ ë¹ ë¥¸ê°€?**
    
    (ëª½ê³ DBëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜ì´ë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì‚¬ìš© ê°€ëŠ¥)
    
    ë‘ êµ¬ë¬¸ ì‹¤í–‰ ê²°ê³¼ InsertManyê°€ í›¨ì”¬ ë¹ ë¥¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    
    ```sql
    for(i = 0 ; i < 300 ; i++) {
        db.insertTest.insertOne({a: i})
    }
    ```
    
    ```sql
    var docs = []
    for (i = 0 ; i < 300 ; i++) { 
        docs.push({a : i})
    }
    db.insertMany.insertMany(docs);
    ```
    

### Update

- **updateOne**
    
    â€œâ€ ìœ¼ë¡œë§Œ ë‘ë©´ í•´ë‹¹ í•„ë“œë¥¼ ì œê±°í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
    
    ```sql
    db.employees.updateOne(
        { name : "river" },
        {
            $set: {
                salary: 35000000,
                dept: "Database",
                joinDate: new ISODate("2023-01-31")
            },
            $unset: {
                isNegotiating: ""
            }
        }
    )
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63b1d762-d817-46a0-8dc0-058d6bc8a20f/Untitled.png)
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ce91cad2-c855-4ea0-9405-763d6f89b1e9/Untitled.png)
    
- **updateMany**
    1. ê·¼ë¬´í•˜ëŠ” ì‚¬ëŒ(í‡´ì‚¬ì¼ì´ ì—†ê³ , ì…ì‚¬ì¼ì´ ìˆëŠ” ì‚¬ëŒ)ì€ ì—°ë´‰ 10% ì¸ìƒ ì¿¼ë¦¬
        
        (Decimal128ì€ ì†Œìˆ˜ì ì„ ì¤„ì´ê¸° ìœ„í•´ì„œ ì‚¬ìš©)
        
        ```sql
        db.employees.updateMany(
            { resignationDate: { $exists: false }, joinDate: { $exists: true } },
            { $mul: { salary: Decimal128("1.1") } }
        )
        ```
        
        ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dbe2f782-f4ec-4eaa-889f-9a3df99e86c9/Untitled.png)
        
    
    1. ë³´ë„ˆìŠ¤ í•„ë“œê°€ ìˆëŠ” ì‚¬ëŒ(ì€í‡´í•œ ì‚¬ëŒ ì œì™¸)ì—ê²Œ ë³´ë„ˆìŠ¤ ì§€ê¸‰ ì¿¼ë¦¬
        
        ```sql
        db.employees.updateMany(
            { resignationDate: { $exists: false }, bonus: { $exists: true } },
            { $set: { bonus: 200000 } }
        )
        ```
        
        ë§Œì•½ ì¿¼ë¦¬ í•„í„°ì— bonus: nullë¡œ í•  ê²½ìš° ë‚´ê°€ ì˜ë„í•œ ê²Œ ì•„ë‹Œ riverë„ ë³´ë„ˆìŠ¤ë¥¼ ë°›ê²Œ ë˜ëŠ” ê²½ìš°ê°€ ìƒê¸¸ìˆ˜ ìˆìœ¼ë‹ˆ ìœ ì˜í•  ê²ƒ!!
        
        ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/212f800a-5770-4b0b-ace0-d63acc4d592d/Untitled.png)
        

### DELETE

- **deleteOne**
    
    ```sql
    db.employees.deleteOne(
        {name: "river" }
    )
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3ee4ecb1-db1e-4a5a-a998-d8caa9e1b1c7/Untitled.png)
    

- **deleteMany**
    
    ì¿¼ë¦¬ í•„í„°ì— ë¹ˆì¹¸ì´ë¼ë„ ë„£ì–´ì¤˜ì•¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë¦¬ê³  ì»¬ë ‰ì…˜ ìì²´ëŠ” ì‚­ì œë˜ì§€ ì•ŠëŠ”ë‹¤.
    
    ```sql
    db.employees.deleteMany({})
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8b9a12cc-022f-429e-b606-690ae6ae735b/Untitled.png)
    
- **drop**
    
    ì»¬ë ‰ì…˜ ì‚­ì œ ì¿¼ë¦¬
    
    ```sql
    db.{collection Name}.drop()
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/62b60e19-dd83-4887-b729-211c104a6f91/Untitled.png)
    

### FIND

- Sample ë°ì´í„° í™œìš©í•  ì˜ˆì •
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7f685ac0-01a7-4fda-98df-ea6da240239f/Untitled.png)
    
- **findOne**
    
    ```sql
    db.planets.findOne({ name: "Mars" })
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8a3fe19d-cbd5-43c0-9f91-ccf320851ae6/Untitled.png)
    
- **find**
    
    ```sql
    // ë§ì„ ê°€ì§€ê³  ìˆê³  orderFromSunì´ 6ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ê°’(, ë¡œ ì—°ê²°í•  ê²½ìš° ê¸°ë³¸ì ìœ¼ë¡œ and ì¡°ê±´)
    db.planets.find({ 
        hasRings: true, 
        orderFromSun: { $lte: 6 }
    })
    
    ==
    
    db.planets.find({ 
        $and: [
            { hasRings: true }, 
            { orderFromSun: { $lte: 6 } }
        ]
    })
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b8c07e11-861d-499f-ba1a-04a7c92a255b/Untitled.png)
    
    ```sql
    // ë§ì´ ì—†ê±°ë‚˜ orderFromSunì´ 6ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ê°’
    
    db.planets.find({ 
        $or: [
            { hasRings: { $ne: false } }, 
            { orderFromSun: { $gt: 6 } }
        ]
    })
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/82aac1e6-03b5-4241-94a4-9ab4975e1c93/Untitled.png)
    
    ```sql
    // íŠ¹ì • ë°°ì—´ì•ˆì— ìˆëŠ” ê°’ì¤‘ì— í•´ë‹¹ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì¿¼ë¦¬
    db.planets.find(
        { mainAtmosphere: { $in: ['O2'] } }
    )
    ```
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5b467ed5-7ac1-456c-acd0-2626eb3498b7/Untitled.png)